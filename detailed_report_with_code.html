<!DOCTYPE html>
<html>
<head>
    <title>Image Enhancement Report with Code</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1400px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        h1 { color: #333; border-bottom: 3px solid #4CAF50; padding-bottom: 10px; }
        h2 { color: #666; margin-top: 30px; background: #f0f0f0; padding: 10px; border-radius: 5px; }
        h3 { color: #444; margin-top: 20px; padding: 5px 10px; background: #f9f9f9; border-left: 4px solid #2196F3; }
        .image-section { margin: 30px 0; padding: 20px; border: 1px solid #ddd; border-radius: 5px; background: #fff; }
        .technique-block { margin: 20px 0; padding: 15px; border: 1px solid #eee; border-radius: 5px; background: #fafafa; }
        .code-section { background: #282c34; color: #abb2bf; padding: 15px; border-radius: 5px; font-family: 'Courier New', monospace; overflow-x: auto; margin: 10px 0; }
        .code-keyword { color: #c678dd; }
        .code-function { color: #61afef; }
        .code-string { color: #98c379; }
        .code-comment { color: #5c6370; font-style: italic; }
        .code-number { color: #d19a66; }
        .image-grid { display: flex; flex-wrap: wrap; gap: 20px; margin: 15px 0; }
        .image-item { flex: 1 1 300px; border: 1px solid #ddd; border-radius: 5px; padding: 10px; background: white; }
        .image-item img { max-width: 100%; height: auto; border-radius: 3px; }
        .image-caption { text-align: center; margin-top: 5px; font-weight: bold; color: #555; }
        .summary { background: #e8f4f8; padding: 20px; border-radius: 5px; margin: 20px 0; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #4CAF50; color: white; }
        tr:nth-child(even) { background-color: #f2f2f2; }
        .success { color: #4CAF50; font-weight: bold; }
        .error { color: #f44336; }
        .header { display: flex; justify-content: space-between; align-items: center; }
        .stats { background: #4CAF50; color: white; padding: 10px 20px; border-radius: 5px; }
        a { color: #2196F3; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .nav { display: flex; gap: 10px; margin: 20px 0; }
        .nav-button { padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; }
        .nav-button:hover { background: #45a049; }
        pre { margin: 0; }
        .toggle-button { background: #2196F3; color: white; border: none; padding: 8px 15px; border-radius: 3px; cursor: pointer; margin: 10px 0; }
        .toggle-button:hover { background: #0b7dda; }
    </style>
    <script>
        function toggleCode(techniqueId) {
            var codeSection = document.getElementById('code-' + techniqueId);
            if (codeSection.style.display === 'none') {
                codeSection.style.display = 'block';
            } else {
                codeSection.style.display = 'none';
            }
        }
        
        function toggleAll(show) {
            var codeSections = document.querySelectorAll('[id^="code-"]');
            codeSections.forEach(function(section) {
                section.style.display = show ? 'block' : 'none';
            });
        }
    </script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Image Enhancement Report with Source Code</h1>
            <div class="stats">
                <div>Generated: 2026-01-20 21:33:41</div>
                <div>Total images: 1</div>
            </div>
        </div>
        
        <div class="nav">
            <button class="nav-button" onclick="toggleAll(true)">Expand All Code</button>
            <button class="nav-button" onclick="toggleAll(false)">Collapse All Code</button>
        </div>
        
        <div class="summary">
            <h2>Processing Summary</h2>
            <table>
                <tr>
                    <th>Image</th>
                    <th>Techniques Applied</th>
                    <th>Successful</th>
                    <th>Results Folder</th>
                </tr>

                <tr>
                    <td><strong>input_image.jpg</strong></td>
                    <td>20/20</td>
                    <td><span class="success">20</span></td>
                    <td><a href="#input_image">Jump to details</a></td>
                </tr>
        
            </table>
        </div>

        <div class="image-section" id="input_image">
            <h2>Image: input_image.jpg</h2>
            
            <div class="technique-block">
                <h3>Original Image</h3>
                <div class="image-grid">
                    <div class="image-item">
                        <img src="00_original.jpg" alt="Original Image">
                        <div class="image-caption">Original Image</div>
                    </div>
                </div>
            </div>
            
            <div class="technique-block">
                <h3>Comparison Grid</h3>
                <div class="image-grid">
                    <div class="image-item">
                        <img src="comparison_grid.jpg" alt="Comparison Grid">
                        <div class="image-caption">All Techniques Comparison</div>
                    </div>
                </div>
            </div>
            
            <h3>Individual Techniques</h3>

            <div class="technique-block">
                <h3>1. 01_Contrast_Stretching</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_0')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_0" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_contrast_stretching(img):
    stretched = np.zeros_like(img, dtype=np.float32)
    for i in range(3):
        channel = img[:, :, i].astype(np.float32)
        min_val, max_val = np.min(channel), np.max(channel)
        if max_val > min_val:
            stretched[:, :, i] = 255 * (channel - min_val) / (max_val - min_val)
    return np.clip(stretched, 0, 255).astype(np.uint8)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="01_contrast_stretching.jpg" alt="01_Contrast_Stretching">
                        <div class="image-caption">01_Contrast_Stretching</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>2. 02_Histogram_Equalization</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_1')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_1" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_histogram_equalization(img):
    hsv = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)
    h, s, v = cv2.split(hsv)
    v_eq = cv2.equalizeHist(v)
    hsv_eq = cv2.merge([h, s, v_eq])
    return cv2.cvtColor(hsv_eq, cv2.COLOR_HSV2BGR)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="02_histogram_equalization.jpg" alt="02_Histogram_Equalization">
                        <div class="image-caption">02_Histogram_Equalization</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>3. 03a_Gamma_Brighter_0.5</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_2')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_2" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_gamma_correction(img):
    """3. Gamma Correction - Returns both brighter and darker versions"""
    def gamma_correction(img, gamma=1.0):
        img_normalized = img.astype(np.float32) / 255.0
        corrected = np.power(img_normalized, gamma)
        return np.clip(corrected * 255, 0, 255).astype(np.uint8)
    
    # 1. Create BRIGHTER image (gamma = 0.5)
    brighter_img = gamma_correction(img, 0.5)
    
    # 2. Create DARKER image (gamma = 1.5)
    darker_img = gamma_correction(img, 1.5)
    
    return brighter_img, darker_img</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="03a_gamma_brighter_0.5.jpg" alt="03a_Gamma_Brighter_0.5">
                        <div class="image-caption">03a_Gamma_Brighter_0.5</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>4. 03b_Gamma_Darker_1.5</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_3')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_3" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_gamma_correction(img):
    """3. Gamma Correction - Returns both brighter and darker versions"""
    def gamma_correction(img, gamma=1.0):
        img_normalized = img.astype(np.float32) / 255.0
        corrected = np.power(img_normalized, gamma)
        return np.clip(corrected * 255, 0, 255).astype(np.uint8)
    
    # 1. Create BRIGHTER image (gamma = 0.5)
    brighter_img = gamma_correction(img, 0.5)
    
    # 2. Create DARKER image (gamma = 1.5)
    darker_img = gamma_correction(img, 1.5)
    
    return brighter_img, darker_img</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="03b_gamma_darker_1.5.jpg" alt="03b_Gamma_Darker_1.5">
                        <div class="image-caption">03b_Gamma_Darker_1.5</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>5. 04_Log_Transform</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_4')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_4" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_log_transform(img):
    img_float = img.astype(np.float32) + 1
    transformed = 40 * np.log(img_float)
    transformed = transformed / np.max(transformed) * 255
    return transformed.astype(np.uint8)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="04_log_transform.jpg" alt="04_Log_Transform">
                        <div class="image-caption">04_Log_Transform</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>6. 05_Thresholding</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_5')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_5" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_thresholding(img):
    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
    _, binary = cv2.threshold(gray, 127, 255, cv2.THRESH_BINARY)
    return cv2.cvtColor(binary, cv2.COLOR_GRAY2BGR)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="05_thresholding.jpg" alt="05_Thresholding">
                        <div class="image-caption">05_Thresholding</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>7. 06_Mean_Filter</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_6')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_6" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_mean_filter(img):
    return cv2.blur(img, (5, 5))</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="06_mean_filter.jpg" alt="06_Mean_Filter">
                        <div class="image-caption">06_Mean_Filter</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>8. 07_Gaussian_Filter</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_7')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_7" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_gaussian_filter(img):
    return cv2.GaussianBlur(img, (5, 5), 1.5)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="07_gaussian_filter.jpg" alt="07_Gaussian_Filter">
                        <div class="image-caption">07_Gaussian_Filter</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>9. 08_Median_Filter</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_8')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_8" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_median_filter(img):
    return cv2.medianBlur(img, 5)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="08_median_filter.jpg" alt="08_Median_Filter">
                        <div class="image-caption">08_Median_Filter</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>10. 09_Bilateral_Filter</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_9')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_9" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_bilateral_filter(img):
    return cv2.bilateralFilter(img, 9, 75, 75)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="09_bilateral_filter.jpg" alt="09_Bilateral_Filter">
                        <div class="image-caption">09_Bilateral_Filter</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>11. 10_Laplacian_Sharpening</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_10')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_10" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_laplacian_sharpening(img):
    img_float = img.astype(np.float32) / 255.0
    laplacian = cv2.Laplacian(img_float, cv2.CV_32F, ksize=3)
    sharpened = img_float + 0.3 * laplacian
    return np.clip(sharpened * 255, 0, 255).astype(np.uint8)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="10_laplacian_sharpening.jpg" alt="10_Laplacian_Sharpening">
                        <div class="image-caption">10_Laplacian_Sharpening</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>12. 11_Unsharp_Masking</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_11')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_11" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_unsharp_masking(img):
    blurred = cv2.GaussianBlur(img, (5, 5), 1.5)
    mask = cv2.subtract(img, blurred)
    return cv2.addWeighted(img, 1.5, mask, -0.5, 0)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="11_unsharp_masking.jpg" alt="11_Unsharp_Masking">
                        <div class="image-caption">11_Unsharp_Masking</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>13. 12_Sobel_Edge</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_12')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_12" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_sobel_edge(img):
    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
    sobelx = cv2.Sobel(gray, cv2.CV_64F, 1, 0, ksize=3)
    sobely = cv2.Sobel(gray, cv2.CV_64F, 0, 1, ksize=3)
    magnitude = np.sqrt(sobelx**2 + sobely**2)
    magnitude = cv2.normalize(magnitude, None, 0, 255, cv2.NORM_MINMAX)
    return cv2.cvtColor(magnitude.astype(np.uint8), cv2.COLOR_GRAY2BGR)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="12_sobel_edge.jpg" alt="12_Sobel_Edge">
                        <div class="image-caption">12_Sobel_Edge</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>14. 13_Fourier_Lowpass</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_13')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_13" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_fourier_lowpass(img):
    channels = cv2.split(img)
    filtered_channels = []
    
    rows, cols = img.shape[:2]
    crow, ccol = rows // 2, cols // 2
    
    mask = np.zeros((rows, cols), np.float32)
    radius = 30
    cv2.circle(mask, (ccol, crow), radius, 1, -1)
    
    for channel in channels:
        f = np.fft.fft2(channel.astype(np.float32))
        fshift = np.fft.fftshift(f)
        fshift_filtered = fshift * mask
        f_ishift = np.fft.ifftshift(fshift_filtered)
        img_back = np.fft.ifft2(f_ishift)
        img_back = np.abs(img_back)
        filtered_channels.append(img_back.astype(np.uint8))
    
    return cv2.merge(filtered_channels)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="13_fourier_lowpass.jpg" alt="13_Fourier_Lowpass">
                        <div class="image-caption">13_Fourier_Lowpass</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>15. 14_Fourier_Highpass</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_14')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_14" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_fourier_highpass(img):
    channels = cv2.split(img)
    filtered_channels = []
    
    rows, cols = img.shape[:2]
    crow, ccol = rows // 2, cols // 2
    
    mask = np.ones((rows, cols), np.float32)
    radius = 30
    cv2.circle(mask, (ccol, crow), radius, 0, -1)
    
    for channel in channels:
        f = np.fft.fft2(channel.astype(np.float32))
        fshift = np.fft.fftshift(f)
        fshift_filtered = fshift * mask
        f_ishift = np.fft.ifftshift(fshift_filtered)
        img_back = np.fft.ifft2(f_ishift)
        img_back = np.abs(img_back)
        filtered_channels.append(img_back.astype(np.uint8))
    
    return cv2.merge(filtered_channels)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="14_fourier_highpass.jpg" alt="14_Fourier_Highpass">
                        <div class="image-caption">14_Fourier_Highpass</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>16. 15_Homomorphic_Filter</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_15')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_15" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_homomorphic_filter(img):
    hsv = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)
    h, s, v = cv2.split(hsv)
    
    v_float = v.astype(np.float32) + 1
    v_log = np.log(v_float)
    
    rows, cols = v.shape
    crow, ccol = rows // 2, cols // 2
    
    H = np.zeros((rows, cols), np.float32)
    gamma_l, gamma_h, c, d0 = 0.5, 2.0, 1.0, 30
    
    for i in range(rows):
        for j in range(cols):
            distance = np.sqrt((i - crow)**2 + (j - ccol)**2)
            H[i, j] = (gamma_h - gamma_l) * (1 - np.exp(-c * (distance**2) / (d0**2))) + gamma_l
    
    v_fft = np.fft.fft2(v_log)
    v_fft_shift = np.fft.fftshift(v_fft)
    v_filtered = v_fft_shift * H
    
    v_ifft_shift = np.fft.ifftshift(v_filtered)
    v_ifft = np.fft.ifft2(v_ifft_shift)
    v_filtered_log = np.real(v_ifft)
    
    v_filtered = np.exp(v_filtered_log) - 1
    v_filtered = cv2.normalize(v_filtered, None, 0, 255, cv2.NORM_MINMAX)
    v_filtered = v_filtered.astype(np.uint8)
    
    hsv_filtered = cv2.merge([h, s, v_filtered])
    return cv2.cvtColor(hsv_filtered, cv2.COLOR_HSV2BGR)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="15_homomorphic_filter.jpg" alt="15_Homomorphic_Filter">
                        <div class="image-caption">15_Homomorphic_Filter</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>17. 16_Color_Correction</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_16')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_16" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_color_correction(img):
    avg_b = np.mean(img[:, :, 0])
    avg_g = np.mean(img[:, :, 1])
    avg_r = np.mean(img[:, :, 2])
    
    avg_gray = (avg_b + avg_g + avg_r) / 3
    
    b_gain = avg_gray / (avg_b + 1e-10)
    g_gain = avg_gray / (avg_g + 1e-10)
    r_gain = avg_gray / (avg_r + 1e-10)
    
    img_float = img.astype(np.float32)
    img_float[:, :, 0] *= b_gain
    img_float[:, :, 1] *= g_gain
    img_float[:, :, 2] *= r_gain
    
    return np.clip(img_float, 0, 255).astype(np.uint8)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="16_color_correction.jpg" alt="16_Color_Correction">
                        <div class="image-caption">16_Color_Correction</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>18. 17_Morphological_Operations</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_17')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_17" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_morphological_ops(img):
    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
    kernel = np.ones((5, 5), np.uint8)
    opened = cv2.morphologyEx(gray, cv2.MORPH_OPEN, kernel)
    return cv2.cvtColor(opened, cv2.COLOR_GRAY2BGR)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="17_morphological_operations.jpg" alt="17_Morphological_Operations">
                        <div class="image-caption">17_Morphological_Operations</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>19. 18_Deblurring</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_18')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_18" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_deblurring(img):
    kernel = np.array([[-1, -1, -1],
                       [-1,  9, -1],
                       [-1, -1, -1]]) / 1.0
    return cv2.filter2D(img, -1, kernel)</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="18_deblurring.jpg" alt="18_Deblurring">
                        <div class="image-caption">18_Deblurring</div>
                    </div>
                </div>

            </div>

            <div class="technique-block">
                <h3>20. 19_Complete_Pipeline</h3>
                
                <button class="toggle-button" onclick="toggleCode('input_image_19')">
                    Show/Hide Code
                </button>
                
                <div id="code-input_image_19" style="display: none;">
                    <div class="code-section">
                        <pre>def technique_complete_pipeline(img):
    step1 = cv2.bilateralFilter(img, 9, 75, 75)
    
    lab = cv2.cvtColor(step1, cv2.COLOR_BGR2LAB)
    l, a, b = cv2.split(lab)
    clahe = cv2.createCLAHE(clipLimit=2.0, tileGridSize=(8, 8))
    l_clahe = clahe.apply(l)
    lab_clahe = cv2.merge([l_clahe, a, b])
    step2 = cv2.cvtColor(lab_clahe, cv2.COLOR_LAB2BGR)
    
    avg_b = np.mean(step2[:, :, 0])
    avg_g = np.mean(step2[:, :, 1])
    avg_r = np.mean(step2[:, :, 2])
    avg_gray = (avg_b + avg_g + avg_r) / 3
    
    b_gain = avg_gray / (avg_b + 1e-10)
    g_gain = avg_gray / (avg_g + 1e-10)
    r_gain = avg_gray / (avg_r + 1e-10)
    
    step3_float = step2.astype(np.float32)
    step3_float[:, :, 0] *= b_gain
    step3_float[:, :, 1] *= g_gain
    step3_float[:, :, 2] *= r_gain
    step3 = np.clip(step3_float, 0, 255).astype(np.uint8)
    
    blurred = cv2.GaussianBlur(step3, (3, 3), 1.5)
    mask = cv2.subtract(step3, blurred)
    step4 = cv2.addWeighted(step3, 1.0 + 0.5, mask, -0.5, 0)
    
    return step4</pre>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="19_complete_pipeline.jpg" alt="19_Complete_Pipeline">
                        <div class="image-caption">19_Complete_Pipeline</div>
                    </div>
                </div>

            </div>

        </div>

    </div>
</body>
</html>